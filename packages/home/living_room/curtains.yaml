living_room_curtains_package:
  cover:
    - platform: template
      covers:
        living_room_curtains:
          friendly_name: "Living Room Curtains"
          optimistic: true
          device_class: curtain
          open_cover:
            - service: cover.close_cover
              target:
                entity_id: cover.living_room_curtains_tahoma
          close_cover:
            - service: cover.open_cover
              target:
                entity_id: cover.living_room_curtains_tahoma
          stop_cover:
            - service: cover.stop_cover
              target:
                entity_id: cover.living_room_curtains_tahoma

  automation:
    - alias: "Living Room: Set curtains"
      id: a8bac767-8172-4ca1-8941-dd1967f868a1
      mode: queued
      trigger:
        - platform: state
          entity_id: binary_sensor.everyone_is_sleeping
          from: "on"
          to: "off"
          id: open_curtains
        - platform: state
          entity_id: input_boolean.sleep_mode
          from: "off"
          to: "on"
          id: close_curtains
        - platform: time
          at: "09:59:00"
          id: open_curtains
      action:
        - choose:
            - conditions:
                - condition: trigger
                  id: open_curtains
                - condition: time
                  after: "06:00:00"
                  before: "10:00:00"
              sequence:
                - service: cover.close_cover
                  data:
                    entity_id: cover.living_room_curtains_tahoma
            - conditions:
                - condition: trigger
                  id: close_curtains
              sequence:
                - service: button.press
                  entity_id: button.living_room_curtains_tahoma_my_position